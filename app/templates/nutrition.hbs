<h3 class="fhir-column-header">Nutrition</h3>
<div id="nutrition-column" class="panel-group fhir-column">
    {{#each model as |nutrition|}}
        {{#draggable-object-target action="createRelation" ontoObject=nutrition}}
            {{#draggable-object content=nutrition}}
                <div {{action "hoverOn" nutrition on="mouseEnter"}} {{action "hoverOff" nutrition on="mouseLeave"}}>
                    {{#fhir-element root=nutrition type='NutritionOrder' as |section|}}
                        {{#if (eq section "expanded")}}
                        {{! THIS IS ONLY FOR SUPPLEMENTS TODO: NiceToHave: Create a type handler that can use the other types}}
                            <div class="row">
                                {{#backbone-element parent=nutrition name='supplement' type='nutrition-order-supplement-component'}}
                                    <div class="form-group">
                                        <div class="col-xs-12 fhir-form-item">
                                            <div class="col-xs-12 col-lg-6">
                                                {{fhir-edit parent=nutrition.supplement.firstObject name='productName'}}
                                                {{#each nutrition.changes.[-supplement-firstObject] as |cr|}}
                                                    {{change-request parent=nutrition.supplement.firstObject name='productName' old=cr.originalValue new=cr.value }}
                                                {{/each}}
                                            </div>
                                            <div class="col-xs-12 col-lg-6">
                                                {{fhir-choice parent=nutrition name='status'
                                                choices='proposed,draft,planned,requested,active,on-hold,completed,cancelled'}}
                                                {{#each nutrition.changes.[-status] as |cr|}}
                                                    {{change-request parent=nutrition name='status' old=cr.originalValue new=cr.value }}
                                                {{/each}}
                                            </div>
                                        </div>
                                        <div class=" col-xs-12 fhir-form-item">
                                            <label class="col-sm-5 control-label" for="type"> Type: </label>
                                            <div id="type" class="col-xs-12 col-lg-7">
                                                {{#codeable-concept parent=nutrition.supplement.firstObject name='type'}}
                                                    {{fhir-edit parent=nutrition.supplement.firstObject.type name='text'}}
                                                {{/codeable-concept}}
                                                {{#each nutrition.changes.[-supplement-firstObject-type-text] as |cr|}}
                                                    {{change-request parent=nutrition.supplement.firstObject.type name='text' old=cr.originalValue new=cr.value }}
                                                {{/each}}

                                            </div>
                                        </div>
                                        <div class=" col-xs-12 fhir-form-item">
                                            <label class="col-xs-12 control-label" for="type"> Instruction: </label>
                                            <div id="type" class="col-xs-12">
                                                {{fhir-edit parent=nutrition.supplement.firstObject name='instruction'}}
                                                {{#each nutrition.changes.[-supplement-firstObject-instruction] as |cr|}}
                                                    {{change-request parent=nutrition.supplement.firstObject name='instruction' old=cr.originalValue new=cr.value }}
                                                {{/each}}
                                            </div>
                                        </div>
                                        <div>
                                            schedule - timing |
                                            quantity - SimpleQuantity |
                                            orderer
                                        </div>
                                    </div>
                                {{/backbone-element}}
                                Ordered On: {{fhir-datetime parent=nutrition name='dateTime' showTime=true}}
                                {{#each nutrition.changes.[-dateTime] as |cr|}}
                                    {{change-request parent=nutrition name='dateTime' old=cr.originalValue new=cr.value }}
                                {{/each}}

                                {{related-list parent=nutrition relation='rlGoals' display='description' label="Goals"}}
                            </div>
                        {{else}}
                            {{nutrition.supplement.firstObject.productName }} - {{nutrition.status}}
                        {{/if}}
                    {{/fhir-element}}
                </div>
            {{/draggable-object}}
        {{/draggable-object-target}}
    {{else}}
        No Nutrition<br/>
    {{/each}}

</div>
<button class="nobackground" {{action 'createRecord' 'NutritionOrder'}}>
    <span class="glyphicon glyphicon-plus"></span> <strong>Add Nutrition</strong>
</button>

<h3>Problems</h3>
<div class="panel-group" style="height:600px;overflow-y:auto;background-color: rgb(201,222,242)">
    {{#each model as |problem|}}
        {{#draggable-object-target action="createRelation" ontoObject=problem}}
            {{#draggable-object content=problem}}
                <div {{action "hoverOn" problem on="mouseEnter"}} {{action "hoverOff" problem on="mouseLeave"}}>
                    {{#fhir-element root=problem type='Condition' as |section|}}
                        {{#if (eq section "expanded")}}
							Identifier(s): {{fhir-identifier parent=problem attribute=problem.identifier name='identifier'}}<br>
							Patient: {{fhir-reference parent=problem.patient}}<br>
							Encounter: {{fhir-reference parent=problem.encounter}}<br>
							Asserter: {{fhir-reference parent=problem.asserter}}<br>
						    Date Recorded: {{fhir-date name='dateRecorded' attribute=problem.dateRecorded}}<br>
                            Code: {{codeable-concept parent=problem attribute=problem.code name='code'}}<br>
                            Category: {{codeable-concept parent=problem attribute=problem.category name='category'}}<br>
							Clinical Status: {{fhir-choice name='clinicalStatus' attribute=problem.clinicalStatus 
								choices='active,relapse,remission,resolved'}}<br>
							Verification Status: {{fhir-choice name='verificationStatus' attribute=problem.verificationStatus 
								choices='provisional,differential,confirmed,refuted,entered-in-error,unknown'}}<br>
                            Severity: {{codeable-concept parent=problem attribute=problem.severity name='severity'}}<br>             
							Onset:
                            {{#fhir-union root=problem
                            choices='[{"name":"onsetDateTime","type":"DateTime"},{"name":"onsetQuantity","type":"Age"},
								    {"name":"onsetPeriod","type":"Period"},{"name":"onsetRange","type":"Range"},
									{"name":"onsetString","type":"Text"}]' as |selected|}}
                                {{#if (eq selected 'onsetDateTime')}}
                                    {{fhir-datetime name='onsetDateTime' attribute=problem.onsetDateTime}}
                                {{else if (eq selected 'onsetQuantity')}}
                                    {{fhir-edit name='onsetQuantity' attribute=problem.onsetQuantity}}
								{{else if (eq selected 'onsetPeriod')}}
								    {{fhir-period parent=problem attribute=problem.onsetPeriod name='onsetPeriod'}}
								{{else if (eq selected 'onsetRange')}}
									{{fhir-range parent=problem attribute=problem.onsetRange name='onsetRange'}}
                                {{else if (eq selected 'onsetString')}}
                                    {{fhir-quantity parent=problem attribute=problem.onsetString name='onsetString'}}
                                {{/if}}
                            {{/fhir-union}}<br>
							Abatement:
                            {{#fhir-union root=problem
                            choices='[{"name":"abatementDateTime","type":"DateTime"},{"name":"abatementQuantity","type":"Age"},{"name":"abatementBoolean","type":"True or False"},
								    {"name":"abatementPeriod","type":"Period"},{"name":"abatementRange","type":"Range"},
									{"name":"abatementString","type":"Text"}]' as |selected|}}
                                {{#if (eq selected 'abatementDateTime')}}
                                    {{fhir-datetime name='abatementDateTime' attribute=problem.abatementDateTime}}
                                {{else if (eq selected 'abatementQuantity')}}
                                    {{fhir-edit name='abatementQuantity' attribute=problem.abatementQuantity}}
								{{else if (eq selected 'abatementBoolean')}}
                                    {{fhir-boolean name='abatementBoolean' attribute=problem.abatementBoolean}}
								{{else if (eq selected 'abatementPeriod')}}
									{{fhir-period parent=problem attribute=problem.abatementPeriod name='abatementPeriod'}}
								{{else if (eq selected 'abatementRange')}}
									{{fhir-range parent=problem attribute=problem.abatementRange name='abatementRange'}}
                                {{else if (eq selected 'abatementString')}}
                                    {{fhir-edit name='abatementString' attribute=problem.abatementString}}
                                {{/if}}
                            {{/fhir-union}}<br>
							Stage: (NONE)<br>
							Evidence: (NONE)<br>
							Body Site: {{codeable-concept parent=problem attribute=problem.bodySite name='bodySite'}}<br>
							Notes: {{fhir-edit name='notes' attribute=problem.notes}}
                        {{else}}
                            {{problem.code.text}} - ({{problem.clinicalStatus}})
                        {{/if}}
                    {{/fhir-element}}
                </div>
                <br/>
            {{/draggable-object}}
        {{/draggable-object-target}}
    {{else}}
        No Problems<br/>
    {{/each}}
    <button class="glyphicon glyphicon-plus" {{action 'createRecord' 'Condition'}}/>
    <strong>Add Problem</strong>
</div>
